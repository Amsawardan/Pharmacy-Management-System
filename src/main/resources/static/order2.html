<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Raj Pharmacy | Orders</title>
    <style>
        body { font-family:'Poppins',sans-serif; background:#f9f9f9; margin:0; padding:0; }
        header { background:#2a9d8f; color:white; text-align:center; padding:20px 0; box-shadow:0 2px 5px rgba(0,0,0,0.1);}
        .order-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(300px,1fr)); gap:20px; padding:30px;}
        .order-card { background:#fff; border-radius:12px; box-shadow:0 4px 8px rgba(0,0,0,0.1); padding:15px; }
        .order-card h3 { margin:0 0 8px; color:#264653; }
        .order-details { font-size:0.9em; color:#555; margin:2px 0; }
    </style>
</head>
<body>
<header>
    <h1>üßæ Raj Pharmacy Orders</h1>
    <p>Order History</p>
</header>

<main>
    <div id="order-container" class="order-grid"></div>
</main>

<script>
    async function loadOrders() {
        try {
            const res = await fetch("http://localhost:8082/orders");
            const orders = await res.json();

            const container = document.getElementById("order-container");
            container.innerHTML = "";

            if (orders.length === 0) {
                container.innerHTML = "<p style='text-align:center;color:#555;'>No orders found.</p>";
                return;
            }

            orders.forEach(order => {
                const card = document.createElement("div");
                card.classList.add("order-card");

                let itemsHTML = "";
                if (order.items && order.items.length > 0) {
                    order.items.forEach(item => {
                        itemsHTML += `<p class="order-details">üíä ${item.medicineName} x${item.quantity} = LKR ${item.price * item.quantity}</p>`;
                    });
                }

                card.innerHTML = `
                    <h3>Order ID: ${order.orderId}</h3>
                    <p class="order-details">Total Items: ${order.orderQuantity}</p>
                    <p class="order-details">Total Value: LKR ${order.orderVal}</p>
                    ${itemsHTML}
                `;
                container.appendChild(card);
            });

        } catch (err) {
            console.error(err);
            document.getElementById("order-container").innerHTML = "<p style='text-align:center;color:red;'>‚ö†Ô∏è Failed to load orders.</p>";
        }
    }

    document.addEventListener("DOMContentLoaded", loadOrders);
</script>
</body>
</html>